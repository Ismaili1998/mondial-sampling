{% extends 'main.html' %}
{% block content %}
{% load format_numbers %}
<main class="container-fluid">
    <div class="p-3 my-3 text-white bg-dark rounded shadow-sm">
        <div class="lh-1">
            <strong> <a href="{% url 'project-home' %}" class="text-white"> Home</a> / Search </strong>
        </div>
    </div>
    <div class="my-3 p-3 border border-1 rounded shadow-sm bg-light">
        {% include 'alert.html' %}
        <form method="GET" action="{% url 'manage-search' %}">
            {% include "search.html" %}
        </form>
        <div class="mt-5 container-fluid size-13">
            <table class="table table-sm">
                <thead>
                    <tr>
                    <th> Client </th>
                    <th> Country </th>
                    <th> Client Ref </th>
                    <th> Detail </th>
                    </tr>
                </thead>
                <tbody>
                    {% for clt in client %}
                    <tr>
                        <td> {{ clt.client_name }} </td>
                        <td> {{ clt.country }} </td>
                        <td> {{ clt.client_nbr }} </td>
                        <td>  </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</main>
{% endblock %}

{% block javascript %}
<script>
        // Add an event listener for input changes
        $('#search_engine').on('input', function () {
            // Get the search keyword
            var keyword = $(this).val().trim();
            // Send an AJAX request to the server
            $.ajax({
                url: '{% url "get-suppliersByKeyWord" %}',
                method: 'GET',
                data: {
                    keyword: keyword
                },
                success: function (response) {
                    // Handle the response from the server
                    var suppliers = response.suppliers;
                    var html = '';

                    // Generate the HTML for the search results
                    for (var i = 0; i < suppliers.length; i++) {
                        html += '<tr>';
                        html += '<td><input class="form-check-input" type="checkbox" value="'+ suppliers[i].id +'" /></td>'
                        html += '<td>' + suppliers[i].supplier_name || '' + '</td>';
                        html += '<td>' + suppliers[i].supplier_nbr + '</td>';
                        html += '<td>' + suppliers[i].country || '' + '</td>';
                        html += '</tr>';
                    }
                    // Update the <tbody> with the search results
                    $('#suppliers-table tbody').html(html)
                }
            });

        });

</script>
{% endblock %}